# Quick Reference Guide

## Command-Line Interface

### Assembly Command

```bash
edasm asm <source.s> [options]
```

**Options:**

- `-o, --output <file>` - Output object file (default: `<input>.obj`)
- `-l, --listing` - Generate assembly listing (`.lst` file)
- `--origin <addr>` - Set assembly origin address
- `--cpu <type>` - CPU type: `6502` or `65C02` (default: `6502`)
- `-r, --relocatable` - Generate relocatable object (REL format)
- `-v, --verbose` - Show detailed progress

**Address Formats:**

- Hexadecimal: `0x8000`, `$8000`, `8000h`
- Decimal: `32768`

**Examples:**

```bash
# Basic assembly
edasm asm program.s

# With listing and custom output
edasm asm program.s -o program.obj -l

# 65C02 with origin address
edasm asm program.s --origin 0xC000 --cpu 65C02

# Relocatable module
edasm asm module1.s -r -v
```

### Link Command

```bash
edasm link <file1.obj> [file2.obj...] [options]
```

**Options:**

- `-o, --output <file>` - Output executable (default: `a.out`)
- `--origin <addr>` - Link origin address
- `-v, --verbose` - Show detailed progress

**Examples:**

```bash
# Link single file
edasm link program.obj -o program

# Link multiple modules
edasm link main.obj lib.obj utils.obj -o program

# Link at specific address
edasm link *.obj --origin 0x8000 -o program.sys
```

### Help & Version

```bash
# Show help
edasm help
edasm --help
edasm -h

# Show version
edasm version
edasm --version
edasm -v
```

## Assembly Language Syntax

### Instructions

All 6502 and 65C02 instructions are supported:

```assembly
; Load/Store
LDA #$42      ; Immediate
LDA $80       ; Zero page
LDA $80,X     ; Zero page,X
LDA $C000     ; Absolute
LDA $C000,X   ; Absolute,X
LDA ($80,X)   ; (Indirect,X)
LDA ($80),Y   ; (Indirect),Y

; 65C02 extensions (use --cpu 65C02)
BRA *+2       ; Branch always
PHX           ; Push X
PLX           ; Pull X
STZ $80       ; Store zero
LDA ($80)     ; (Indirect)
```

### Directives

```assembly
; Origin
      ORG $8000     ; Set assembly address

; Constants
MAX   EQU 255       ; Define constant

; Data
      DB $01,$02    ; Define bytes
      DW $1234      ; Define word (little-endian)
      ASC "TEXT"    ; ASCII string
      DCI "TEXT"    ; ASCII with inverted last char
      DS 10         ; Define space (10 bytes)

; Relocatable modules
      REL           ; Relocatable mode
      EXT PRINT     ; External reference
      ENT MAIN      ; Entry point
```

### Labels

```assembly
; Global labels (start in column 1)
MAIN  LDA #$00
      JMP LOOP

; Local labels (start with .)
LOOP  DEX
.WAIT BNE .WAIT
      RTS
```

### Expressions

```assembly
; Arithmetic
      LDA #10+20    ; Addition
      LDA #100-50   ; Subtraction
      LDA #8*4      ; Multiplication
      LDA #100/5    ; Division

; Byte extraction
ADDR  EQU $1234
      LDA #<ADDR    ; Low byte ($34)
      LDA #>ADDR    ; High byte ($12)

; Parentheses
      LDA #(10+20)*3  ; Grouping
```

### Comments

```assembly
; Full-line comment

LDA #$42  ; Inline comment
```

## Output Files

### Object Files (`.obj`)

Binary object code with symbol table and relocation information.

### Listing Files (`.lst`)

Human-readable assembly listing showing:

- Address
- Generated bytes (hex)
- Source line

Example:

```
8000  A9 42         LDA #$42
8002  8D 00 C0      STA $C000
8005  60            RTS
```

### Attributes (dotfiles)

ProDOS file attributes stored in JSON:

```json
{
  "fileType": 254,
  "auxType": 32768,
  "created": "2026-02-06T...",
  "modified": "2026-02-06T..."
}
```

Stored in `.filename` (e.g., `.program.obj` for `program.obj`)

## Multi-Module Projects

### Creating Modules

**Module 1 (main.s):**

```assembly
      REL
      EXT SUBROUTINE
      ENT MAIN

      ORG $8000
MAIN  JSR SUBROUTINE
      RTS
```

**Module 2 (lib.s):**

```assembly
      REL
      ENT SUBROUTINE

      ORG $8000
SUBROUTINE
      LDA #$42
      RTS
```

### Assembling Modules

```bash
edasm asm main.s -r -o main.obj
edasm asm lib.s -r -o lib.obj
```

### Linking

```bash
edasm link main.obj lib.obj -o program --origin 0x8000
```

## Error Messages

### Common Errors

**Undefined Symbol:**

```
Line 10: Undefined symbol: UNKNOWN
```

_Solution:_ Define the symbol or add EXT directive for external symbol.

**Invalid Opcode:**

```
Line 5: Unknown mnemonic: INVALID
```

_Solution:_ Check spelling and CPU type (6502 vs 65C02).

**Branch Out of Range:**

```
Line 20: Branch target out of range (-130 bytes)
```

_Solution:_ Use JMP for long branches or reorganize code.

**Duplicate Label:**

```
Line 15: Symbol 'LOOP' already defined at line 8
```

_Solution:_ Rename duplicate label or use local labels.

**File Not Found:**

```
Error: Cannot read file: program.s
  ENOENT: no such file or directory
```

_Solution:_ Check file path and spelling.

## Tips & Tricks

### Efficient Assembly

1. **Use local labels** for loops:

   ```assembly
   FUNC  LDX #10
   .LOOP DEX
         BNE .LOOP
         RTS
   ```

2. **Define constants** for magic numbers:

   ```assembly
   SCRN  EQU $C000
         LDA #$20
         STA SCRN
   ```

3. **Use byte extraction** for addresses:

   ```assembly
   ADDR  EQU $1234
         LDA #<ADDR
         STA $80
         LDA #>ADDR
         STA $81
   ```

### Debugging

1. **Generate listing** with `-l`:

   ```bash
   edasm asm program.s -l
   ```

   Review `program.obj.lst` to see generated addresses and bytes.

2. **Use verbose mode** with `-v`:

   ```bash
   edasm asm program.s -v
   ```

   See assembly progress and configuration.

3. **Check symbol values** in listing file - symbols are shown with their resolved addresses.

### Performance

- **Zero page** addressing is faster and smaller than absolute:

  ```assembly
  LDA $80     ; 2 bytes, 3 cycles
  LDA $C000   ; 3 bytes, 4 cycles
  ```

- **Branches** are smaller than jumps:

  ```assembly
  BNE LOOP    ; 2 bytes (if in range)
  JMP LOOP    ; 3 bytes (always)
  ```

## Platform Notes

### ProDOS Compatibility

TS-EDASM emulates ProDOS file attributes using JSON dotfiles:

```bash
ls -la
-rw-r--r-- program.obj
-rw-r--r-- .program.obj  # Attributes
```

To transfer to ProDOS, extract attributes from JSON and set with ProDOS tools.

### Linux Differences

- **File paths**: Use forward slashes (`/path/to/file`)
- **No resource forks**: All data in single file
- **Case sensitive**: `Program.s` â‰  `program.s`
- **Line endings**: LF (`\n`) or CRLF (`\r\n`) both supported

## Further Reading

- **6502 Reference**: <http://www.6502.org/>
- **65C02 Extensions**: <http://www.6502.org/tutorials/65c02opcodes.html>
- **ProDOS Technical Reference**: <https://prodos8.com/>
- **Original EdAsm**: <https://github.com/markpmlim/EdAsm>

## Getting Help

```bash
# Built-in help
edasm help

# Report issues
https://github.com/<your-repo>/issues
```

---

**Version**: 0.1.0  
**Last Updated**: February 6, 2026
